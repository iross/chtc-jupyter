Bootstrap: docker
From: nvidia/cuda:12.4.1-runtime-ubuntu22.04

%post
    # Update software repositories and install dependencies
    chmod 777 /tmp
    apt-get update
    apt-get install software-properties-common -y
    add-apt-repository ppa:deadsnakes/ppa -y

    # Set timezone non-interactively
    export DEBIAN_FRONTEND=noninteractive
    export TZ=America/Chicago
    apt-get update

    # Install python and pip
    apt-get install -y \
        python3.12 python3.12-dev python3.12-venv zip \
        && update-alternatives --install /usr/bin/python python /usr/bin/python3.12 1 \
        && python -m ensurepip --upgrade \
        && rm -rf /var/lib/apt/lists/*

    # Copy requirements file and install dependencies
    cd /app
    pip3.12 install -r requirements.txt

%environment
    export TZ=America/Chicago

%files
    requirements.txt /app/requirements.txt
